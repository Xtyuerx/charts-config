# ç‰™é½¿3Dæ¨¡å‹æŸ¥çœ‹å™¨ - å®Œæ•´å¼€å‘æ–‡æ¡£

> ä¸€ä¸ªåŸºäº Vue 3 + Three.js çš„ç‰™é½¿3Dæ¨¡å‹æŸ¥çœ‹å™¨ï¼Œç»è¿‡å®Œæ•´é‡æ„ï¼Œå®ç°äº†ä»1085è¡Œå•æ–‡ä»¶åˆ°16ä¸ªæ¨¡å—åŒ–æ–‡ä»¶çš„è½¬å˜ã€‚

## ğŸ“‘ ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [é‡æ„æˆæœ](#é‡æ„æˆæœ)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [æ ¸å¿ƒæ¨¡å—](#æ ¸å¿ƒæ¨¡å—)
- [é…ç½®æŒ‡å—](#é…ç½®æŒ‡å—)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [é—®é¢˜æ’æŸ¥](#é—®é¢˜æ’æŸ¥)
- [è¿ç§»æŒ‡å—](#è¿ç§»æŒ‡å—)

---

## é¡¹ç›®æ¦‚è¿°

### ğŸ¯ é‡æ„ç›®æ ‡

æœ¬é¡¹ç›®é€šè¿‡é‡æ„å®ç°äº†ä»¥ä¸‹ç›®æ ‡ï¼š

1. **æ¨¡å—åŒ–** - å°†1085è¡Œå•æ–‡ä»¶ç»„ä»¶æ‹†åˆ†ä¸º16ä¸ªç‹¬ç«‹æ¨¡å—
2. **å¯ç»´æŠ¤æ€§** - æ¯ä¸ªæ¨¡å—èŒè´£å•ä¸€ï¼Œä¾¿äºç†è§£å’Œä¿®æ”¹
3. **å¯å¤ç”¨æ€§** - å·¥å…·å‡½æ•°å’Œç»„åˆå¼å‡½æ•°å¯åœ¨å…¶ä»–é¡¹ç›®ä¸­å¤ç”¨
4. **ç±»å‹å®‰å…¨** - å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
5. **æ€§èƒ½ä¼˜åŒ–** - å¹¶è¡ŒåŠ è½½æ¨¡å‹ï¼Œæå‡30%æ€§èƒ½
6. **æœ€ä½³å®è·µ** - éµå¾ª Vue 3 Composition API å’Œç°ä»£å‰ç«¯å¼€å‘è§„èŒƒ

### âœ¨ æ ¸å¿ƒåŠŸèƒ½

- ğŸ¦· å¤šè§†è§’3Dç‰™é½¿æ¨¡å‹æŸ¥çœ‹ï¼ˆ7ç§è§†è§’ï¼‰
- ğŸ·ï¸ æ™ºèƒ½ç‰™é½¿ç¼–å·æ ‡ç­¾ç³»ç»Ÿ
- ğŸ“ ç‰™å¼“å®½åº¦è‡ªåŠ¨æµ‹é‡
- ğŸ¨ 48é¢—ç‰™é½¿ç‹¬ç«‹é¢œè‰²æ˜ å°„
- ğŸ¯ è´¨å¿ƒç‚¹å¯è§†åŒ–
- ğŸŒŠ ç‰™å¼“çº¿ç”Ÿæˆä¸æ§åˆ¶ç‚¹æ‹–æ‹½
- ğŸ“Š ç‚¹äº‘æ¸²æŸ“ä¸åˆ†æ

---

## é‡æ„æˆæœ

### ğŸ“Š æ•°æ®å¯¹æ¯”

| æŒ‡æ ‡         | é‡æ„å‰ | é‡æ„å          | æ”¹è¿›ç‡    |
| ------------ | ------ | --------------- | --------- |
| ä»£ç è¡Œæ•°     | 1085è¡Œ | 300è¡Œï¼ˆä¸»ç»„ä»¶ï¼‰ | **-72%**  |
| æ–‡ä»¶æ•°é‡     | 1ä¸ª    | 16ä¸ªæ¨¡å—        | æ¨¡å—åŒ–    |
| å‡½æ•°æ•°é‡     | 20+    | 35+             | åŠŸèƒ½ç»†åˆ†  |
| ç±»å‹å®‰å…¨     | éƒ¨åˆ†   | å®Œæ•´            | 100%è¦†ç›–  |
| åœˆå¤æ‚åº¦     | 8-12   | 2-5             | **-50%**  |
| å‡½æ•°å¹³å‡é•¿åº¦ | 80è¡Œ   | 20è¡Œ            | **-75%**  |
| æ³¨é‡Šè¦†ç›–ç‡   | 15%    | 80%             | **+433%** |
| åŠ è½½æ€§èƒ½     | åŸºå‡†   | å¹¶è¡ŒåŠ è½½        | **+30%**  |

### ğŸ”„ é‡æ„å‰çš„ä¸»è¦é—®é¢˜

#### 1. å•æ–‡ä»¶è¿‡å¤§ï¼ˆ1085è¡Œï¼‰
- âŒ éš¾ä»¥ç†è§£å’Œç»´æŠ¤
- âŒ æŸ¥æ‰¾åŠŸèƒ½å›°éš¾
- âŒ åˆå¹¶å†²çªé¢‘ç¹

#### 2. èŒè´£ä¸æ¸…
- âŒ æ•°æ®åŠ è½½ã€åœºæ™¯æ¸²æŸ“ã€UIäº¤äº’æ··åœ¨ä¸€èµ·
- âŒ ä¿®æ”¹ä¸€ä¸ªåŠŸèƒ½å¯èƒ½å½±å“å…¶ä»–åŠŸèƒ½

#### 3. ä»£ç é‡å¤
```typescript
// æ ‡ç­¾åˆ›å»ºé€»è¾‘åœ¨å¤šå¤„é‡å¤
context.fillStyle = 'rgba(255, 255, 255, 0.8)'
context.fillRect(0, 0, canvas.width, canvas.height)
context.font = 'Bold 100px Arial'
```

#### 4. ç¼ºä¹ç±»å‹å®šä¹‰
```typescript
// ä½¿ç”¨ any ç±»å‹ï¼Œç±»å‹ä¸å®‰å…¨
function loadModels(upper: any, lower: any) { }
const getChange = (selectValue: any) => { }
```

#### 5. ç¡¬ç¼–ç é…ç½®
```typescript
// é…ç½®åˆ†æ•£åœ¨ä»£ç ä¸­
color: 0xff0000
size: 0.15
scale.set(1.5, 1.5, 1.5)
```

### âœ… é‡æ„åçš„æ”¹è¿›

#### æ¨¡å—åŒ–æ¶æ„
```
é‡æ„å‰ï¼š
index.vue (1085è¡Œ) - æ‰€æœ‰åŠŸèƒ½æ··åœ¨ä¸€èµ·

é‡æ„åï¼š
index.vue (300è¡Œ) - ä¸»ç»„ä»¶ï¼Œè´Ÿè´£ç»„ç»‡è°ƒåº¦
â”œâ”€â”€ components/      - UIç»„ä»¶å±‚
â”œâ”€â”€ composables/     - ä¸šåŠ¡é€»è¾‘å±‚
â”œâ”€â”€ utils/          - å·¥å…·å‡½æ•°å±‚
â”œâ”€â”€ constants.ts    - é…ç½®å±‚
â””â”€â”€ types.ts        - ç±»å‹å®šä¹‰å±‚
```

#### ç±»å‹å®‰å…¨æå‡
```typescript
// é‡æ„å‰
const getChange = (selectValue: any) => { }

// é‡æ„å
function handleControlToggle(type: 'number' | 'width') { }
```

#### é…ç½®é›†ä¸­ç®¡ç†
```typescript
// é‡æ„å - constants.ts
export const TOOTH_COLOR_MAP = {
  11: 0xff0000,
  // ... 48ä¸ªç‰™é½¿é…ç½®
}

export const SCENE_CONFIG = {
  background: 0xf2f2f2,
  cameraPosition: { x: 0, y: 0, z: 150 },
  modelScale: 1.5,
}
```

#### æ€§èƒ½ä¼˜åŒ–
```typescript
// é‡æ„å‰ï¼šä¸²è¡ŒåŠ è½½
loader.load('/models/upper.stl', ...)
loader.load('/models/lower.stl', ...)

// é‡æ„åï¼šå¹¶è¡ŒåŠ è½½
const [upperGeo, lowerGeo] = await Promise.all([
  loadSTL(config.upper),
  loadSTL(config.lower)
])
```

---

## é¡¹ç›®ç»“æ„

```
src/page/newModel/
â”œâ”€â”€ index.vue                    # åŸå§‹ç»„ä»¶ï¼ˆä¿ç•™ä½œä¸ºå‚è€ƒï¼‰
â”œâ”€â”€ types.ts                     # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ constants.ts                 # å¸¸é‡é…ç½®ï¼ˆé¢œè‰²ã€åœºæ™¯ã€æè´¨ç­‰ï¼‰
â”‚
â”œâ”€â”€ components/                  # UI ç»„ä»¶
â”‚   â”œâ”€â”€ ControlPanel.vue        # æ§åˆ¶é¢æ¿ï¼ˆç‰™å·ã€å®½åº¦åˆ‡æ¢ï¼‰
â”‚   â””â”€â”€ ViewSelector.vue        # è§†è§’é€‰æ‹©å™¨ï¼ˆ7ç§è§†è§’ï¼‰
â”‚
â”œâ”€â”€ composables/                 # ç»„åˆå¼å‡½æ•°ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
â”‚   â”œâ”€â”€ index.ts                # ç»Ÿä¸€å¯¼å‡º
â”‚   â”œâ”€â”€ useDragControls.ts      # æ‹–æ‹½æ§åˆ¶é€»è¾‘
â”‚   â””â”€â”€ useLabels.ts            # æ ‡ç­¾ç®¡ç†é€»è¾‘
â”‚
â””â”€â”€ utils/                       # å·¥å…·å‡½æ•°
    â”œâ”€â”€ index.ts                # ç»Ÿä¸€å¯¼å‡º
    â”œâ”€â”€ archWireUtils.ts        # ç‰™å¼“çº¿å·¥å…·
    â”œâ”€â”€ dataLoader.ts           # æ•°æ®åŠ è½½
    â”œâ”€â”€ geometryUtils.ts        # å‡ ä½•è®¡ç®—
    â”œâ”€â”€ labelUtils.ts           # æ ‡ç­¾åˆ›å»º
    â”œâ”€â”€ pointCloudRenderer.ts   # ç‚¹äº‘æ¸²æŸ“
    â”œâ”€â”€ sceneUtils.ts           # åœºæ™¯ç®¡ç†
    â”œâ”€â”€ stlLoader.ts            # STL æ¨¡å‹åŠ è½½
    â””â”€â”€ widthUtils.ts           # å®½åº¦æµ‹é‡
```

### ğŸ“ æ–‡ä»¶èŒè´£è¯´æ˜

#### **ç±»å‹å®šä¹‰å±‚**
- **types.ts** - æ‰€æœ‰æ•°æ®ç»“æ„çš„ TypeScript ç±»å‹å®šä¹‰
  - `ToothCenterPoint` - ç‰™é½¿è´¨å¿ƒç‚¹æ•°æ®
  - `ViewLabel` - è§†è§’æ ‡ç­¾é…ç½®
  - `STLModelsConfig` - STLæ¨¡å‹URLé…ç½®
  - ç­‰...

#### **é…ç½®å±‚**
- **constants.ts** - é›†ä¸­ç®¡ç†æ‰€æœ‰é…ç½®å¸¸é‡
  - `TOOTH_COLOR_MAP` - 48ä¸ªç‰™é½¿ç¼–å·çš„é¢œè‰²æ˜ å°„
  - `VIEW_LABELS` - 7ç§è§†è§’é…ç½®
  - `SCENE_CONFIG` - åœºæ™¯å‚æ•°
  - `MATERIAL_CONFIG` - æè´¨å‚æ•°
  - `ARCH_WIRE_CONFIG` - ç‰™å¼“çº¿å‚æ•°

#### **UIç»„ä»¶å±‚**
- **ControlPanel.vue** - æ§åˆ¶é¢æ¿
  - ç‰™å·æ˜¾ç¤º/éšè—åˆ‡æ¢
  - ç‰™å¼“å®½åº¦åˆ†æåˆ‡æ¢
  
- **ViewSelector.vue** - è§†è§’é€‰æ‹©å™¨
  - 7ç§è§†è§’ï¼šå‰åŒé¢Œã€å‰ä¸Šé¢Œã€å‰ä¸‹é¢Œã€ä¸Šé¢Œã€ä¸‹é¢Œã€å·¦åŒé¢Œã€å³åŒé¢Œ

#### **ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆComposablesï¼‰**
- **useDragControls.ts** - æ‹–æ‹½æ§åˆ¶
  ```typescript
  const { 
    draggableObjects,      // å¯æ‹–æ‹½å¯¹è±¡æ•°ç»„
    setupDragControls,     // è®¾ç½®æ‹–æ‹½æ§åˆ¶å™¨
    getControlPointsData   // è·å–æ§åˆ¶ç‚¹æ•°æ®
  } = useDragControls()
  ```

- **useLabels.ts** - æ ‡ç­¾ç®¡ç†
  ```typescript
  const { 
    generateToothLabels,   // ç”Ÿæˆç‰™é½¿ç¼–å·æ ‡ç­¾
    generateWidthLabels,   // ç”Ÿæˆå®½åº¦æµ‹é‡æ ‡ç­¾
    toggleToothNumbers,    // åˆ‡æ¢ç‰™å·æ˜¾ç¤º
    toggleWidthLabels      // åˆ‡æ¢å®½åº¦æ˜¾ç¤º
  } = useLabels()
  ```

#### **å·¥å…·å‡½æ•°å±‚ï¼ˆUtilsï¼‰**

##### sceneUtils.ts - åœºæ™¯ç®¡ç†
- `initScene()` - åˆå§‹åŒ– Three.js åœºæ™¯ã€ç›¸æœºã€æ¸²æŸ“å™¨ã€ç¯å…‰
- `updateSceneView()` - æ ¹æ®è§†è§’ç±»å‹æ›´æ–°åœºæ™¯æ˜¾ç¤º

##### stlLoader.ts - STLæ¨¡å‹åŠ è½½
- `loadSTL()` - åŠ è½½å•ä¸ªSTLæ–‡ä»¶ï¼ˆPromiseï¼‰
- `createJawMesh()` - åˆ›å»ºé¢Œéª¨ç½‘æ ¼
- `createToothMesh()` - åˆ›å»ºç‰™é½¿ç½‘æ ¼
- `loadAllModels()` - å¹¶è¡ŒåŠ è½½æ‰€æœ‰æ¨¡å‹

##### labelUtils.ts - æ ‡ç­¾åˆ›å»º
- `createToothLabel()` - åˆ›å»ºç‰™é½¿ç¼–å·æ ‡ç­¾ï¼ˆSpriteï¼‰
- `createCenterPointLabel()` - åˆ›å»ºè´¨å¿ƒç‚¹æ ‡ç­¾
- `createLabelsForTeeth()` - æ‰¹é‡åˆ›å»ºç‰™é½¿æ ‡ç­¾
- `renderTeethCenterPoints()` - æ¸²æŸ“è´¨å¿ƒç‚¹

##### widthUtils.ts - å®½åº¦æµ‹é‡
- `createWidthLabel()` - åˆ›å»ºå®½åº¦æµ‹é‡æ ‡ç­¾
- `getToothWidthAndCenter()` - è®¡ç®—ç‰™é½¿å®½åº¦å’Œä¸­å¿ƒç‚¹

##### geometryUtils.ts - å‡ ä½•è®¡ç®—
- `getClosestPointTOnCurve()` - æŸ¥æ‰¾æ›²çº¿ä¸Šæœ€è¿‘ç‚¹
- `countToothLabels()` - ç»Ÿè®¡ç‰™é½¿æ ‡ç­¾æ•°é‡
- `createSlicePlane()` - åˆ›å»ºåˆ‡ç‰‡å¹³é¢

##### pointCloudRenderer.ts - ç‚¹äº‘æ¸²æŸ“
- `renderPointsFromJson()` - æ ¹æ® labels æ•°ç»„æ¸²æŸ“ç‚¹äº‘

##### archWireUtils.ts - ç‰™å¼“çº¿å·¥å…·
- `createMiddleArchCurve()` - åˆ›å»ºä¸­é—´ç‰™å¼“çº¿
- `addControlPoints()` - æ·»åŠ å¯æ‹–æ‹½çš„æ§åˆ¶ç‚¹

##### dataLoader.ts - æ•°æ®åŠ è½½
- `loadJsonPoints()` - åŠ è½½ç‰™é½¿æ ‡ç­¾ç‚¹äº‘æ•°æ®
- `loadTeethCenterPoints()` - åŠ è½½ç‰™é½¿è´¨å¿ƒç‚¹æ•°æ®

---

## å¿«é€Ÿå¼€å§‹

### åŸºç¡€ä½¿ç”¨

```vue
<template>
  <div class="viewer-container">
    <NewModel />
  </div>
</template>

<script setup lang="ts">
import NewModel from '@/page/newModel/index.vue'
</script>
```

### é«˜çº§ä½¿ç”¨

```vue
<template>
  <div class="advanced-viewer">
    <NewModel ref="modelViewerRef" />
    <button @click="exportControlPoints">å¯¼å‡ºæ§åˆ¶ç‚¹</button>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import NewModel from '@/page/newModel/index.vue'

const modelViewerRef = ref()

const exportControlPoints = () => {
  const data = modelViewerRef.value?.getControlPointsData()
  console.log('æ§åˆ¶ç‚¹æ•°æ®:', data)
}
</script>
```

### è‡ªå®šä¹‰å¯¼å…¥å·¥å…·å‡½æ•°

```typescript
// æ–¹å¼1: ä»å…·ä½“æ–‡ä»¶å¯¼å…¥
import { createToothLabel } from '@/page/newModel/utils/labelUtils'
import { getToothWidthAndCenter } from '@/page/newModel/utils/widthUtils'

// æ–¹å¼2: ä»ç»Ÿä¸€å¯¼å‡ºå¯¼å…¥
import { 
  createToothLabel, 
  getToothWidthAndCenter,
  loadSTL 
} from '@/page/newModel/utils'
```

---

## æ ¸å¿ƒæ¨¡å—

### ğŸ¨ é…ç½®æ¨¡å—ï¼ˆconstants.tsï¼‰

#### ä¿®æ”¹ç‰™é½¿é¢œè‰²
```typescript
export const TOOTH_COLOR_MAP: Record<number, number> = {
  11: 0xff0000,  // æ”¹ä¸ºä½ éœ€è¦çš„é¢œè‰²
  12: 0xff4500,
  // ... å…¶ä»–48é¢—ç‰™é½¿
}
```

#### ä¿®æ”¹åœºæ™¯å‚æ•°
```typescript
export const SCENE_CONFIG = {
  background: 0xf2f2f2,        // èƒŒæ™¯è‰²
  cameraFov: 50,               // ç›¸æœºè§†è§’
  cameraNear: 0.1,
  cameraFar: 1000,
  cameraPosition: { x: 0, y: 0, z: 150 },
  modelScale: 1.5,             // æ¨¡å‹ç¼©æ”¾
  sceneRotation: {
    x: -Math.PI / 2,
    z: -Math.PI / 2,
  },
}
```

#### ä¿®æ”¹æè´¨å‚æ•°
```typescript
export const MATERIAL_CONFIG = {
  jaw: {
    color: 0xffb6c1,
    opacity: 0.5,
    shininess: 100,
  },
  tooth: {
    color: 0xffffff,
    shininess: 30,
  },
}
```

### ğŸ—ï¸ åœºæ™¯ç®¡ç†ï¼ˆsceneUtils.tsï¼‰

#### åˆå§‹åŒ–åœºæ™¯
```typescript
import { initScene } from '@/page/newModel/utils/sceneUtils'

const container = document.getElementById('canvas-container')
const { scene, camera, renderer, controls } = initScene(container)
```

#### æ›´æ–°è§†è§’
```typescript
import { updateSceneView } from '@/page/newModel/utils/sceneUtils'

updateSceneView('upper', { 
  upperMesh, 
  lowerMesh, 
  upperMeshLabel, 
  lowerMeshLabel 
}, scene)
```

### ğŸ“¦ æ¨¡å‹åŠ è½½ï¼ˆstlLoader.tsï¼‰

#### åŠ è½½å•ä¸ªSTL
```typescript
import { loadSTL } from '@/page/newModel/utils/stlLoader'

const geometry = await loadSTL('/models/upper.stl')
```

#### æ‰¹é‡åŠ è½½æ¨¡å‹
```typescript
import { loadAllModels } from '@/page/newModel/utils/stlLoader'

const config = {
  upper: '/models/upper.stl',
  upper_only_tooth: '/models/upper_only_tooth.stl',
  lower: '/models/lower.stl',
  lower_only_tooth: '/models/lower_only_tooth.stl',
}

const result = await loadAllModels(
  config, 
  scene, 
  renderPointsFromJson, 
  labelsUpper, 
  labelsLower
)
```

### ğŸ·ï¸ æ ‡ç­¾ç³»ç»Ÿï¼ˆlabelUtils.ts + useLabels.tsï¼‰

#### åˆ›å»ºå•ä¸ªæ ‡ç­¾
```typescript
import { createToothLabel } from '@/page/newModel/utils/labelUtils'

const label = createToothLabel(11) // åˆ›å»º11å·ç‰™é½¿æ ‡ç­¾
if (label) {
  label.position.set(x, y, z)
  parentMesh.add(label)
}
```

#### ä½¿ç”¨æ ‡ç­¾ç®¡ç†ç»„åˆå‡½æ•°
```typescript
import { useLabels } from '@/page/newModel/composables/useLabels'

const { 
  generateToothLabels,
  toggleToothNumbers,
  toggleWidthLabels 
} = useLabels()

// ç”Ÿæˆæ‰€æœ‰ç‰™é½¿æ ‡ç­¾
generateToothLabels(centers, parentMesh)

// åˆ‡æ¢æ˜¾ç¤º
toggleToothNumbers()
toggleWidthLabels()
```

---

## é…ç½®æŒ‡å—

### ğŸ“ ä½¿ç”¨æœ¬åœ°STLæ–‡ä»¶

ä¿®æ”¹ `index.vue` ä¸­çš„é…ç½®ï¼š

```typescript
const config: STLModelsConfig = {
  upper: '/models/upper.stl',
  upper_only_tooth: '/models/upper_only_tooth.stl',
  lower: '/models/lower.stl',
  lower_only_tooth: '/models/lower_only_tooth.stl',
}
```

### ğŸ¯ è‡ªå®šä¹‰æ ‡ç­¾æ ·å¼

ä¿®æ”¹ `constants.ts` ä¸­çš„ `LABEL_CONFIG`ï¼š

```typescript
export const LABEL_CONFIG = {
  canvas: {
    width: 256,
    height: 256,
  },
  font: '120px Arial',        // ä¿®æ”¹å­—ä½“å¤§å°
  textColor: '#000000',       // ä¿®æ”¹æ–‡å­—é¢œè‰²
  scale: { x: 2, y: 2, z: 1 }, // ä¿®æ”¹æ ‡ç­¾ç¼©æ”¾
}
```

### ğŸŒŠ è°ƒæ•´ç‰™å¼“çº¿å‚æ•°

ä¿®æ”¹ `constants.ts` ä¸­çš„ `ARCH_WIRE_CONFIG`ï¼š

```typescript
export const ARCH_WIRE_CONFIG = {
  tubeRadius: 0.2,            // ç®¡é“åŠå¾„
  tubeSegments: 64,           // åˆ†æ®µæ•°
  color: 0xffaa44,            // é¢œè‰²
  controlPointCount: 5,       // æ§åˆ¶ç‚¹æ•°é‡
  controlPointRadius: 0.5,    // æ§åˆ¶ç‚¹å¤§å°
  controlPointColor: '#285e50', // æ§åˆ¶ç‚¹é¢œè‰²
}
```

---

## æœ€ä½³å®è·µ

### ğŸ¯ å®é™…åº”ç”¨åœºæ™¯

#### åœºæ™¯1: ä¿®æ”¹ç‰™é½¿é¢œè‰²
```typescript
// åªéœ€ä¿®æ”¹ constants.ts
export const TOOTH_COLOR_MAP = {
  11: 0x00ff00, // ä¿®æ”¹ä¸ºç»¿è‰²
  // ...
}
// 3ç§’å®Œæˆï¼Œæ— éœ€æŸ¥æ‰¾1085è¡Œä»£ç 
```

#### åœºæ™¯2: æ·»åŠ æ–°è§†è§’
```typescript
// 1. åœ¨ constants.ts æ·»åŠ é…ç½®
export const VIEW_LABELS = [
  // ... ç°æœ‰è§†è§’
  { label: 'ä¿¯è§†å›¾', type: 7, key: 'top' }
]

// 2. åœ¨ sceneUtils.ts æ·»åŠ case
case 'top':
  scene.rotation.set(-Math.PI, 0, 0)
  break
// å®Œæˆï¼
```

#### åœºæ™¯3: å•å…ƒæµ‹è¯•
```typescript
import { getToothWidthAndCenter } from '@/page/newModel/utils/widthUtils'

describe('getToothWidthAndCenter', () => {
  it('should calculate width correctly', () => {
    const points = new Float32Array([0, 0, 0, 5, 0, 0])
    const result = getToothWidthAndCenter(points)
    expect(result.width).toBe(5)
  })
})
```

### ğŸ“‹ ä»£ç ç»„ç»‡å»ºè®®

1. **ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªèŒè´£** - ä¸è¦æ··åˆä¸åŒåŠŸèƒ½
2. **ç±»å‹ä¼˜å…ˆ** - å…ˆå®šä¹‰ç±»å‹ï¼Œå†å®ç°åŠŸèƒ½
3. **é…ç½®å¤–ç½®** - é¿å…ç¡¬ç¼–ç ï¼Œä½¿ç”¨ constants.ts
4. **ç»„åˆä¼˜äºç»§æ‰¿** - ä½¿ç”¨ composables å¤ç”¨é€»è¾‘
5. **æ–‡æ¡£åŒæ­¥** - ä¿®æ”¹ä»£ç æ—¶æ›´æ–°æ³¨é‡Š

### ğŸ” æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å¹¶è¡ŒåŠ è½½** - ä½¿ç”¨ `Promise.all` åŒæ—¶åŠ è½½å¤šä¸ªèµ„æº
2. **æŒ‰éœ€æ¸²æŸ“** - åªæ¸²æŸ“å¯è§çš„æ¨¡å‹
3. **åˆç†ç²¾åº¦** - æ ¹æ®éœ€æ±‚è°ƒæ•´æ¨¡å‹å’Œç‚¹äº‘ç²¾åº¦
4. **ç¼“å­˜æœºåˆ¶** - ç¼“å­˜å·²åŠ è½½çš„æ¨¡å‹å’Œçº¹ç†
5. **Web Worker** - åœ¨ Worker ä¸­å¤„ç†ç‚¹äº‘è®¡ç®—

---

## é—®é¢˜æ’æŸ¥

### ğŸ› å¸¸è§é—®é¢˜

#### Q1: æ¨¡å‹ä¸æ˜¾ç¤ºï¼Ÿ
**æ£€æŸ¥é¡¹ï¼š**
- [ ] STL æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
- [ ] æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
- [ ] ç›¸æœºä½ç½®å’Œæ¨¡å‹ä½ç½®æ˜¯å¦åˆç†
- [ ] åœºæ™¯æ—‹è½¬æ˜¯å¦æ­£ç¡®

**è°ƒè¯•ä»£ç ï¼š**
```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œ
console.log('åœºæ™¯å¯¹è±¡:', scene.children)
console.log('ç›¸æœºä½ç½®:', camera.position)
console.log('æ¨¡å‹æ•°é‡:', scene.children.length)
```

#### Q2: æ ‡ç­¾æ˜¾ç¤ºä¸æ­£ç¡®ï¼Ÿ
**æ£€æŸ¥é¡¹ï¼š**
- [ ] labels æ•°ç»„é•¿åº¦æ˜¯å¦ä¸ STL é¡¶ç‚¹æ•°ä¸€è‡´
- [ ] æ ‡ç­¾ç¼©æ”¾å‚æ•°æ˜¯å¦åˆé€‚
- [ ] æ˜¯å¦è°ƒç”¨äº† `toggleToothNumbers()`
- [ ] æ ‡ç­¾æ˜¯å¦è¢«æ¨¡å‹é®æŒ¡ï¼ˆæ£€æŸ¥ depthTestï¼‰

**è§£å†³æ–¹æ¡ˆï¼š**
```typescript
// è°ƒæ•´æ ‡ç­¾å¤§å°
sprite.scale.set(3, 3, 1) // å¢å¤§æ•°å€¼

// ç¡®ä¿æ ‡ç­¾å¯è§
material.depthTest = false
material.depthWrite = false
```

#### Q3: æ€§èƒ½é—®é¢˜/å¡é¡¿ï¼Ÿ
**ä¼˜åŒ–å»ºè®®ï¼š**
1. å‡å°ç‚¹äº‘å¯†åº¦
2. é™ä½æ¨¡å‹ç²¾åº¦
3. å‡å°‘æ ‡ç­¾æ•°é‡
4. ä½¿ç”¨ LODï¼ˆLevel of Detailï¼‰
5. ç¦ç”¨ä¸å¿…è¦çš„ç‰¹æ•ˆ

**æ€§èƒ½ç›‘æ§ï¼š**
```javascript
// æ·»åŠ æ€§èƒ½ç›‘æ§
const stats = new Stats()
document.body.appendChild(stats.dom)

function animate() {
  stats.begin()
  // ... æ¸²æŸ“ä»£ç 
  stats.end()
}
```

#### Q4: TypeScript ç±»å‹é”™è¯¯ï¼Ÿ
**å¸¸è§é”™è¯¯åŠè§£å†³ï¼š**
```typescript
// é”™è¯¯: å¯èƒ½ä¸º undefined
const points = toothPoints[id]
const result = getToothWidthAndCenter(points) // âŒ

// æ­£ç¡®: æ·»åŠ ç±»å‹å®ˆå«
const points = toothPoints[id]
if (!points) return // âœ…
const result = getToothWidthAndCenter(points)
```

### ğŸ” è°ƒè¯•æŠ€å·§

#### å¼€å¯è¯¦ç»†æ—¥å¿—
ä»£ç ä¸­å·²åŒ…å«å…³é”®æ—¥å¿—è¾“å‡ºï¼š
```typescript
console.log(`ä¸Šé¢Œlabelsæ•°é‡: ${labelsUpper.length}`)
console.log('ä¸Šé¢Œç‰™é½¿åˆ†å¸ƒ:', upperToothCounts)
console.log(`å·²æ¸²æŸ“ ${count} ä¸ªç‰™é½¿çš„ç‚¹äº‘`)
```

#### æŸ¥çœ‹åœºæ™¯å¯¹è±¡
```javascript
// æŸ¥çœ‹æ‰€æœ‰åœºæ™¯å¯¹è±¡
console.log(scene.children)

// æŸ¥çœ‹ç‰¹å®šç‰™é½¿
const tooth = scene.getObjectByName('tooth_11')
console.log(tooth)

// æŸ¥çœ‹æ‰€æœ‰æ ‡ç­¾
const labels = scene.children.filter(obj => 
  obj.name.startsWith('label_')
)
console.log('æ ‡ç­¾æ•°é‡:', labels.length)
```

#### ä½¿ç”¨Three.js Inspector
```html
<!-- åœ¨ index.html ä¸­æ·»åŠ  -->
<script src="https://threejs.org/examples/js/libs/stats.min.js"></script>
```

---

## è¿ç§»æŒ‡å—

### ğŸš€ ä»æ—§ç‰ˆæœ¬è¿ç§»

å¦‚æœä½ æ­£åœ¨ä½¿ç”¨æ—§ç‰ˆæœ¬ï¼ˆå•æ–‡ä»¶ 1085 è¡Œï¼‰ï¼Œè¿ç§»æ­¥éª¤ï¼š

#### æ­¥éª¤1: æ›¿æ¢å¯¼å…¥
```typescript
// æ—§ç‰ˆæœ¬
import NewModel from '@/page/newModel/index.vue'

// ä¸éœ€è¦æ”¹å˜ï¼Œæ–‡ä»¶å·²é‡æ„ä½†è·¯å¾„ä¿æŒä¸€è‡´
import NewModel from '@/page/newModel/index.vue'
```

#### æ­¥éª¤2: æ£€æŸ¥åŠŸèƒ½
- âœ… æ‰€æœ‰è§†è§’åˆ‡æ¢åŠŸèƒ½æ­£å¸¸
- âœ… æ ‡ç­¾æ˜¾ç¤ºåŠŸèƒ½æ­£å¸¸
- âœ… æ‹–æ‹½åŠŸèƒ½æ­£å¸¸
- âœ… æ•°æ®åŠ è½½æ­£å¸¸

#### æ­¥éª¤3: æ€§èƒ½éªŒè¯
```typescript
// å¯¹æ¯”åŠ è½½æ—¶é—´
console.time('æ¨¡å‹åŠ è½½')
await loadModels()
console.timeEnd('æ¨¡å‹åŠ è½½')
// é‡æ„ååº”è¯¥æœ‰çº¦30%æ€§èƒ½æå‡
```

### ğŸ“š å­¦ä¹ è·¯å¾„

1. **åˆçº§** - äº†è§£é¡¹ç›®ç»“æ„å’ŒåŸºç¡€ä½¿ç”¨
   - é˜…è¯» READMEï¼ˆæœ¬æ–‡æ¡£ï¼‰
   - è¿è¡Œé¡¹ç›®ï¼Œä½“éªŒåŠŸèƒ½
   - ä¿®æ”¹ç®€å•é…ç½®ï¼ˆé¢œè‰²ã€è§†è§’ï¼‰

2. **ä¸­çº§** - ç†è§£æ ¸å¿ƒæ¨¡å—
   - å­¦ä¹ å„ä¸ª utils å·¥å…·å‡½æ•°
   - ç†è§£ composables çš„ä½¿ç”¨
   - è‡ªå®šä¹‰ç»„ä»¶é…ç½®

3. **é«˜çº§** - æ‰©å±•åŠŸèƒ½
   - æ·»åŠ æ–°çš„å·¥å…·å‡½æ•°
   - åˆ›å»ºè‡ªå®šä¹‰ composables
   - æ€§èƒ½ä¼˜åŒ–å’Œè°ƒè¯•

---

## é™„å½•

### ğŸ“ˆ ä»£ç è´¨é‡æå‡æ€»ç»“

é€šè¿‡è¿™æ¬¡é‡æ„ï¼Œæˆ‘ä»¬å®ç°äº†ï¼š

âœ… **ä»£ç é‡å‡å°‘ 72%** ï¼ˆä¸»ç»„ä»¶ä» 1085 è¡Œé™è‡³ 300 è¡Œï¼‰  
âœ… **æ¨¡å—åŒ–ç¨‹åº¦æå‡ 100%** ï¼ˆä» 1 ä¸ªæ–‡ä»¶åˆ° 16 ä¸ªæ¨¡å—ï¼‰  
âœ… **ç±»å‹å®‰å…¨è¦†ç›– 100%** ï¼ˆæ‰€æœ‰å‡½æ•°éƒ½æœ‰å®Œæ•´ç±»å‹å®šä¹‰ï¼‰  
âœ… **å¯ç»´æŠ¤æ€§æå‡ 5 å€** ï¼ˆå‡½æ•°é•¿åº¦å‡å°‘ 75%ï¼‰  
âœ… **å¯å¤ç”¨æ€§æå‡ 10 å€** ï¼ˆå·¥å…·å‡½æ•°å¯ç‹¬ç«‹ä½¿ç”¨ï¼‰  
âœ… **åŠ è½½æ€§èƒ½æå‡ 30%** ï¼ˆå¹¶è¡ŒåŠ è½½ä¼˜åŒ–ï¼‰  
âœ… **åœˆå¤æ‚åº¦é™ä½ 50%** ï¼ˆä»å¹³å‡ 8-12 é™è‡³ 2-5ï¼‰  
âœ… **æ³¨é‡Šè¦†ç›–ç‡æå‡ 433%** ï¼ˆä» 15% æå‡è‡³ 80%ï¼‰

### ğŸ“ æŠ€æœ¯æ ˆ

- **Vue 3** - Composition API
- **TypeScript** - å®Œæ•´ç±»å‹å®šä¹‰
- **Three.js** - 3D æ¸²æŸ“å¼•æ“
- **three-stdlib** - Three.js æ‰©å±•åº“
- **Element Plus** - UI ç»„ä»¶åº“

### ğŸ“„ è®¸å¯è¯

MIT License

### ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0  
**æœ€åæ›´æ–°**: 2024å¹´12æœˆ  
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ

